import matplotlib.colors as colors
import numpy as np
import skgstat as skg

# define the Geosoft K65 colormap
def geosoft_cmap_k65():
  geosoft_cmap_k65 = [
      [0.0, 0.0, 0.745098],
      [0.0, 0.248366, 0.745098],
      [0.0, 0.371088, 0.745098],
      [0.0, 0.496732, 0.745098],
      [0.0, 0.619454, 0.745098],
      [0.0, 0.680815, 0.745098],
      [0.0, 0.745098, 0.745098],
      [0.0, 0.745098, 0.584391],
      [0.0, 0.745098, 0.423683],
      [0.0, 0.745098, 0.184083],
      [0.0, 0.745098, 0.143176],
      [0.0, 0.745098, 0.10519],
      [0.0, 0.745098, 0.0],
      [0.210381, 0.745098, 0.0],
      [0.289273, 0.745098, 0.0],
      [0.318493, 0.745098, 0.0],
      [0.423683, 0.745098, 0.0],
      [0.531795, 0.745098, 0.0],
      [0.636986, 0.745098, 0.0],
      [0.745098, 0.745098, 0.0],
      [0.745098, 0.680815, 0.0],
      [0.745098, 0.619454, 0.0],
      [0.745098, 0.558093, 0.0],
      [0.745098, 0.525952, 0.0],
      [0.745098, 0.496732, 0.0],
      [0.745098, 0.432449, 0.0],
      [0.745098, 0.400308, 0.0],
      [0.745098, 0.371088, 0.0],
      [0.745098, 0.309727, 0.0],
      [0.745098, 0.248366, 0.0],
      [0.745098, 0.154864, 0.0],
      [0.745098, 0.061361, 0.0],
      [0.745098, 0.0, 0.0],
      [0.745098, 0.0, 0.160707],
      [0.745098, 0.0, 0.318493],
      [0.745098, 0.0, 0.531795],
      [0.745098, 0.032141, 0.636986],
      [0.745098, 0.353556, 0.745098],
      [0.745098, 0.464591, 0.745098],
  ]

  geosoft_cmap_k65 = colors.LinearSegmentedColormap.from_list("geosoft_cmap_k65", geosoft_cmap_k65, N=1000)
  return geosoft_cmap_k65


def cluster_variogram(df_fl, value_or_residual, idx_cluster, maxlag, n_lags):

    df = df_fl[df_fl['cluster']==idx_cluster]
    coords = df[['x','y']].values
    values_for_variogram = df[value_or_residual]
    Vgram = skg.Variogram(coords, values_for_variogram, bin_func = "even", n_lags = n_lags, maxlag = maxlag, normalize=False)

    return Vgram